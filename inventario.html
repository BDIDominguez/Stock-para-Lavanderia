<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>Inventario</title>

<style>
body{background:#000;color:#fff;margin:0;font-family:Arial;text-align:center;}

#piso{
 width:90%;padding:6px;margin-top:6px;
 font-size:18px;font-weight:bold;border-radius:6px;
 background:#131313;color:#00d7ff;border:2px solid #00aaff;
}

.grid{
 display:grid;
 grid-template-columns:repeat(4,1fr);
 gap:3px;width:96%;margin:6px auto;
}

.box{
 background:#115;padding:3px;border-radius:4px;
 font-size:20px;font-weight:bold;
 display:flex;justify-content:center;align-items:center;
}

input{
 width:40%;background:#000;border:1px solid #333;
 font-size:20px;color:#00ff8c;border-radius:4px;text-align:center;
 pointer-events:none; /* evita teclado mÃ³vil */
}

/* Campo seleccionado */
.active{
 border:2px solid #00eaff !important;
 background:#003e4f !important;
 color:white !important;
}

.pad{
 display:grid;grid-template-columns:repeat(3,1fr);
 gap:4px;width:96%;margin:auto;margin-top:4px;
}

.pad button{
 padding:16px;font-size:22px;border:none;border-radius:6px;
 background:#202020;color:white;font-weight:bold;
}

/* Botones anterior / siguiente ahora grandes */
.ops{
 display:flex;justify-content:space-between;margin-top:15px;width:88%;margin-left:auto;margin-right:auto;
}

.ops button{
 width:48%;padding:15px;font-size:24px;border:none;border-radius:8px;font-weight:bold;
 background:#444;color:white;
}

.save{background:#00b94d;color:white;width:92%;margin-top:8px;padding:13px;border-radius:8px;font-size:20px}
.back{background:#777;width:92%;margin-top:4px;padding:11px;border-radius:8px;font-size:18px}
</style>
</head>
<body>

<h3 style="margin:6px 0">ðŸ“¥ INVENTARIO POR PISO</h3>

<select id="piso"></select>

<div class="grid">
 <div class="box">B <input id="B" readonly></div>
 <div class="box">T <input id="T" readonly></div>
 <div class="box">P <input id="P" readonly></div>
 <div class="box">SG<input id="SG" readonly></div>

 <div class="box">SCH<input id="SCH" readonly></div>
 <div class="box">F <input id="F" readonly></div>
 <div class="box">K <input id="K" readonly></div>
 <div class="box">3SG<input id="3SG" readonly></div>

 <div class="box">3SCH<input id="3SCH" readonly></div>
 <div class="box">3K<input id="3K" readonly></div>
 <div class="box">OCUP<input id="OC" readonly></div>
</div>

<div class="pad">
 <button onclick="press(1)">1</button><button onclick="press(2)">2</button><button onclick="press(3)">3</button>
 <button onclick="press(4)">4</button><button onclick="press(5)">5</button><button onclick="press(6)">6</button>
 <button onclick="press(7)">7</button><button onclick="press(8)">8</button><button onclick="press(9)">9</button>
 <button onclick="press(0)">0</button><button onclick="clr()">C</button><button onclick="setValue()">SET</button>
</div>

<div class="ops">
 <button onclick="prev()">â—€ ANTERIOR</button>
 <button onclick="next()">SIGUIENTE â–¶</button>
</div>

<button class="save" onclick="save()">ðŸ’¾ GUARDAR</button>
<button class="back" onclick="location.href='index.html'">â¬… VOLVER</button>

<script>
let data={}, campos=["B","T","P","SG","SCH","F","K","3SG","3SCH","3K","OC"], pos=0,newEntry=true;

function load(){
 fetch("./base.txt").then(r=>r.text()).then(t=>{
  t.trim().split("\n").slice(1).forEach(l=>{
   let p=l.split(",")[0];
   piso.innerHTML+=`<option>${p}</option>`;
   if(!data[p])data[p]={B:0,T:0,P:0,SG:0,SCH:0,F:0,K:0,"3SG":0,"3SCH":0,"3K":0,OC:0};
  });
  if(localStorage.getItem("linv")) data = JSON.parse(localStorage.getItem("linv"));
  loadInputs(); highlight();
 });
}

function loadInputs(){
 let d=data[piso.value];
 campos.forEach(c=>document.getElementById(c).value=d[c]);
 newEntry=true;
}

function press(v){
 let i=document.getElementById(campos[pos]);
 if(newEntry){ i.value=""; newEntry=false; }
 i.value+=v;
}

function clr(){
 document.getElementById(campos[pos]).value="";
 newEntry=true;
}

function setValue(){
 let v=prompt("Valor nuevo:");
 if(v!==null){
  document.getElementById(campos[pos]).value=+v;
  newEntry=true;
 }
}

function save(){
 let p=piso.value;
 campos.forEach(c=>data[p][c]=+(document.getElementById(c).value||0));
 localStorage.setItem("linv",JSON.stringify(data));
 alert("âœ” Inventario guardado");
}

function next(){ pos=(pos+1)%campos.length; clearOnSelect(); }
function prev(){ pos=(pos-1+campos.length)%campos.length; clearOnSelect(); }

function clearOnSelect(){
 campos.forEach(c=>document.getElementById(c).classList.remove("active"));
 let input=document.getElementById(campos[pos]);
 input.classList.add("active");
 newEntry=true;
}

piso.onchange=loadInputs;

load();
</script>

</body>
</html>
